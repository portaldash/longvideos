<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>CSV Viewer - Paginated</title>
<style>
  body {
    margin: 0;
    padding: 10px;
    background-color: #000;
    color: #0f0;
    font-family: monospace;
  }
  #controls {
    margin-bottom: 10px;
  }
  button {
    background: #111;
    border: 1px solid #0f0;
    color: #0f0;
    padding: 5px 10px;
    cursor: pointer;
    margin-right: 5px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
  }
  th, td {
    border: 1px solid #0f0;
    padding: 4px 6px;
    text-align: left;
  }
  tr:nth-child(even) {
    background-color: #002200;
  }
</style>
</head>
<body>

<div id="controls">
  <button id="prevBtn">Prev</button>
  <span id="pageInfo">Page 1</span>
  <button id="nextBtn">Next</button>
</div>

<table id="csvTable"></table>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
  const CSV_URL = "https://1b2e6f8d-d553-4f38-8e9a-f432ecd32939-00-f6ednmntwg59.picard.replit.dev/long_videos.csv";
  const ROWS_PER_PAGE = 10000;
  let allData = [];
  let currentPage = 0;

  async function loadCSV() {
    const response = await fetch(CSV_URL);
    const csvText = await response.text();

    // Parse CSV with PapaParse, header:true to get array of objects
    const parsed = Papa.parse(csvText, {
      header: true,
      skipEmptyLines: true,
    });

    allData = parsed.data;
    renderPage();
  }

  function renderPage() {
    const start = currentPage * ROWS_PER_PAGE;
    const end = Math.min(start + ROWS_PER_PAGE, allData.length);

    const table = document.getElementById("csvTable");
    table.innerHTML = "";

    // Headers from keys of first row
    if (allData.length === 0) {
      table.textContent = "No data loaded.";
      return;
    }
    const headers = Object.keys(allData[0]);

    // Create header row
    const thead = document.createElement("thead");
    const headerRow = document.createElement("tr");
    headers.forEach(h => {
      const th = document.createElement("th");
      th.textContent = h;
      headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    table.appendChild(thead);

    // Create body rows
    const tbody = document.createElement("tbody");
    for (let i = start; i < end; i++) {
      const row = allData[i];
      const tr = document.createElement("tr");
      headers.forEach(h => {
        const td = document.createElement("td");
        td.textContent = row[h];
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    }
    table.appendChild(tbody);

    // Update page info
    document.getElementById("pageInfo").textContent =
      `Page ${currentPage + 1} (${start + 1} - ${end} of ${allData.length})`;
  }

  document.getElementById("prevBtn").addEventListener("click", () => {
    if (currentPage > 0) {
      currentPage--;
      renderPage();
    }
  });

  document.getElementById("nextBtn").addEventListener("click", () => {
    if ((currentPage + 1) * ROWS_PER_PAGE < allData.length) {
      currentPage++;
      renderPage();
    }
  });

  loadCSV();
</script>

</body>
</html>
